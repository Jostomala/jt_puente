<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="robots" content="noindex,nofollow" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Verificacion de correo | Don Chuck</title>
    <style>
      :root { color-scheme: light dark; }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        min-height: 100dvh;
        display: grid;
        place-items: center;
        background: #0b0d12;
        color: #e7e9ee;
      }
      .card {
        width: min(560px, 92vw);
        padding: 28px 24px;
        border-radius: 16px;
        background: #121622;
        border: 1px solid #1e2433;
        box-shadow: 0 10px 30px rgba(0,0,0,0.35);
        text-align: center;
      }
      .ok {
        display: inline-grid;
        place-items: center;
        width: 64px; height: 64px;
        margin: 0 auto 12px;
        border-radius: 50%;
        background: #14321f;
        border: 1px solid #215a35;
        font-size: 18px;
        font-weight: 700;
        letter-spacing: 1px;
      }
      .status-error .ok {
        background: #321414;
        border-color: #5a2121;
      }
      h1 { font-size: 22px; margin: 10px 0 6px; }
      p { margin: 6px 0 0; opacity: .9; }
      .muted { opacity: .6; font-size: 13px; margin-top: 10px; }
    </style>
  </head>
  <body>
    <main class="card" id="card" role="main" aria-live="polite">
      <div class="ok" id="icon" aria-hidden="true">OK</div>
      <h1 id="title">Correo verificado</h1>
      <p id="message">Tu cuenta fue confirmada correctamente.</p>
      <p class="muted" id="hint">Ya puedes cerrar esta pagina y volver a la app para iniciar sesion.</p>
    </main>
    <script>
      (function () {
        function parseParams() {
          var params = new URLSearchParams(window.location.search || '');
          var hash = window.location.hash || '';
          var qIndex = hash.indexOf('?');
          if (qIndex !== -1) {
            var hashParams = new URLSearchParams(hash.slice(qIndex + 1));
            hashParams.forEach(function (value, key) {
              if (!params.has(key)) params.set(key, value);
            });
          }
          return params;
        }

        var params = parseParams();
        var error = params.get('error');
        var errorCode = params.get('error_code');
        var errorDesc = params.get('error_description');
        var code = params.get('code');

        var card = document.getElementById('card');
        var title = document.getElementById('title');
        var message = document.getElementById('message');
        var hint = document.getElementById('hint');

        if (error || errorCode) {
          card.classList.add('status-error');
          document.title = 'Enlace no valido | Don Chuck';
          if (errorCode === 'otp_expired') {
            title.textContent = 'Enlace expirado';
            message.textContent = 'El enlace de verificacion expiro.';
          } else {
            title.textContent = 'No se pudo verificar';
            message.textContent = 'El enlace no es valido o ya fue usado.';
          }
          if (errorDesc) {
            hint.textContent = decodeURIComponent(errorDesc.replace(/\+/g, ' '));
          } else {
            hint.textContent = 'Solicita un nuevo correo de verificacion e intenta otra vez.';
          }
          return;
        }

        if (code) {
          document.title = 'Correo verificado | Don Chuck';
          title.textContent = 'Correo verificado';
          message.textContent = 'Tu cuenta fue confirmada correctamente.';
          hint.textContent = 'Ya puedes cerrar esta pagina y volver a la app para iniciar sesion.';
          return;
        }

        document.title = 'Verificacion pendiente | Don Chuck';
        title.textContent = 'Verificando enlace';
        message.textContent = 'No detectamos parametros de verificacion.';
        hint.textContent = 'Si el problema persiste, solicita un nuevo correo.';
      })();
    </script>
  </body>
</html>
